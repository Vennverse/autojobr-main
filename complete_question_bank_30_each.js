import postgres from 'postgres';

const client = postgres(process.env.DATABASE_URL);

// COMPLETING QUESTION BANK TO EXACTLY 30 PER DOMAIN
const REMAINING_QUESTIONS = [
  // ==================== ENGLISH - 1 MORE QUESTION ====================
  { questionId: 'eng_030', type: 'multiple_choice', category: 'english', domain: 'general', subCategory: 'reading_comprehension', difficulty: 'hard', question: 'What can be inferred from: "Despite his reticent nature, John\'s ideas always commanded attention in meetings"?', options: ['John talks too much', 'John is naturally quiet but has valuable insights', 'John is unconfident', 'John dominates meetings'], correctAnswer: '1', explanation: 'Reticent means quiet/reserved, but "despite" suggests his ideas are still valued, indicating quiet wisdom', points: 4, timeLimit: 3, tags: ['inference', 'vocabulary_in_context'], keywords: ['reticent', 'inference', 'despite'] },

  // ==================== COMPUTER SCIENCE - 10 MORE QUESTIONS ====================
  { questionId: 'tech_021', type: 'multiple_choice', category: 'domain_specific', domain: 'computer_science', subCategory: 'ai_ml', difficulty: 'hard', question: 'What is the purpose of gradient descent in neural networks?', options: ['To increase model complexity', 'To optimize weights by minimizing loss', 'To add more layers', 'To preprocess data'], correctAnswer: '1', explanation: 'Gradient descent optimizes neural network weights by iteratively minimizing the loss function.', points: 4, timeLimit: 3, tags: ['neural_networks', 'optimization'], keywords: ['gradient_descent', 'optimization', 'neural_networks'] },
  { questionId: 'tech_022', type: 'multiple_choice', category: 'domain_specific', domain: 'computer_science', subCategory: 'system_design', difficulty: 'hard', question: 'What is database sharding?', options: ['Creating database backups', 'Horizontally partitioning data across multiple databases', 'Encrypting database content', 'Compressing database files'], correctAnswer: '1', explanation: 'Sharding is a method of horizontally partitioning data across multiple database instances to improve performance and scalability.', points: 4, timeLimit: 3, tags: ['databases', 'scalability'], keywords: ['sharding', 'partitioning', 'scalability'] },
  { questionId: 'tech_023', type: 'multiple_choice', category: 'domain_specific', domain: 'computer_science', subCategory: 'concurrency', difficulty: 'hard', question: 'What is a race condition?', options: ['When code runs too fast', 'When multiple threads access shared resources unsafely', 'When a loop runs infinitely', 'When memory runs out'], correctAnswer: '1', explanation: 'A race condition occurs when multiple threads access shared data concurrently without proper synchronization.', points: 4, timeLimit: 3, tags: ['concurrency', 'threading'], keywords: ['race_condition', 'threads', 'synchronization'] },
  { questionId: 'tech_024', type: 'multiple_choice', category: 'domain_specific', domain: 'computer_science', subCategory: 'data_science', difficulty: 'medium', question: 'What does ETL stand for in data processing?', options: ['Extract, Transform, Load', 'Execute, Test, Launch', 'Encode, Transfer, Link', 'Evaluate, Train, Learn'], correctAnswer: '0', explanation: 'ETL (Extract, Transform, Load) is a data integration process that combines data from multiple sources.', points: 3, timeLimit: 2, tags: ['data_processing', 'ETL'], keywords: ['ETL', 'data_integration', 'pipeline'] },
  { questionId: 'tech_025', type: 'multiple_choice', category: 'domain_specific', domain: 'computer_science', subCategory: 'cryptography', difficulty: 'hard', question: 'What is the difference between symmetric and asymmetric encryption?', options: ['Speed only', 'Symmetric uses one key, asymmetric uses two keys', 'No difference', 'Complexity level'], correctAnswer: '1', explanation: 'Symmetric encryption uses the same key for encryption and decryption, while asymmetric uses a public/private key pair.', points: 4, timeLimit: 3, tags: ['cryptography', 'encryption'], keywords: ['symmetric', 'asymmetric', 'encryption'] },
  { questionId: 'tech_026', type: 'multiple_choice', category: 'domain_specific', domain: 'computer_science', subCategory: 'containers', difficulty: 'medium', question: 'What is Docker primarily used for?', options: ['Database management', 'Containerizing applications', 'Web development', 'Network security'], correctAnswer: '1', explanation: 'Docker is a containerization platform that packages applications and dependencies into lightweight, portable containers.', points: 3, timeLimit: 2, tags: ['docker', 'containers'], keywords: ['docker', 'containerization', 'deployment'] },
  { questionId: 'tech_027', type: 'multiple_choice', category: 'domain_specific', domain: 'computer_science', subCategory: 'big_data', difficulty: 'medium', question: 'What are the 3 Vs of Big Data?', options: ['Volume, Velocity, Variety', 'Value, Version, Verification', 'Virtual, Visual, Verbal', 'Vendor, Variable, Vector'], correctAnswer: '0', explanation: 'The 3 Vs of Big Data are Volume (amount), Velocity (speed), and Variety (different types) of data.', points: 3, timeLimit: 2, tags: ['big_data', 'data_characteristics'], keywords: ['big_data', 'volume', 'velocity', 'variety'] },
  { questionId: 'tech_028', type: 'multiple_choice', category: 'domain_specific', domain: 'computer_science', subCategory: 'regex', difficulty: 'hard', question: 'What does the regex pattern \\d{3}-\\d{2}-\\d{4} match?', options: ['Phone numbers', 'Social Security Numbers', 'IP addresses', 'Zip codes'], correctAnswer: '1', explanation: 'This pattern matches XXX-XX-XXXX format, which is the standard format for US Social Security Numbers.', points: 4, timeLimit: 3, tags: ['regex', 'pattern_matching'], keywords: ['regex', 'pattern', 'SSN'] },
  { questionId: 'tech_029', type: 'multiple_choice', category: 'domain_specific', domain: 'computer_science', subCategory: 'mvc', difficulty: 'medium', question: 'In MVC architecture, what is the role of the Controller?', options: ['Manages data and business logic', 'Handles user interface', 'Manages user input and coordinates between Model and View', 'Stores application data'], correctAnswer: '2', explanation: 'The Controller handles user input, processes it, and coordinates between the Model (data) and View (presentation).', points: 3, timeLimit: 2, tags: ['MVC', 'architecture'], keywords: ['MVC', 'controller', 'architecture'] },
  { questionId: 'tech_030', type: 'multiple_choice', category: 'domain_specific', domain: 'computer_science', subCategory: 'quantum_computing', difficulty: 'hard', question: 'What is a qubit in quantum computing?', options: ['A type of classical bit', 'A quantum bit that can be in superposition', 'A quantum computer brand', 'A quantum algorithm'], correctAnswer: '1', explanation: 'A qubit is the basic unit of quantum information that can exist in superposition of 0 and 1 states simultaneously.', points: 5, timeLimit: 4, tags: ['quantum_computing', 'qubits'], keywords: ['qubit', 'quantum', 'superposition'] },

  // ==================== SALES - 20 MORE QUESTIONS ====================
  { questionId: 'sales_011', type: 'multiple_choice', category: 'domain_specific', domain: 'sales', subCategory: 'prospecting', difficulty: 'medium', question: 'What is the BANT qualification framework?', options: ['Budget, Authority, Need, Timeline', 'Business, Analysis, Network, Trust', 'Benefits, Advantages, Numbers, Terms', 'Brand, Audience, Needs, Technology'], correctAnswer: '0', explanation: 'BANT helps qualify prospects based on Budget, Authority to buy, Need for the solution, and Timeline for implementation.', points: 3, timeLimit: 2, tags: ['qualification', 'BANT'], keywords: ['BANT', 'qualification', 'budget', 'authority'] },
  { questionId: 'sales_012', type: 'multiple_choice', category: 'domain_specific', domain: 'sales', subCategory: 'sales_psychology', difficulty: 'hard', question: 'What is the "scarcity principle" in sales?', options: ['Making products expensive', 'Creating urgency through limited availability', 'Selling only premium products', 'Reducing sales team size'], correctAnswer: '1', explanation: 'Scarcity principle leverages people\'s tendency to value things more when they appear limited or exclusive.', points: 4, timeLimit: 3, tags: ['psychology', 'scarcity'], keywords: ['scarcity', 'urgency', 'psychology'] },
  { questionId: 'sales_013', type: 'multiple_choice', category: 'domain_specific', domain: 'sales', subCategory: 'account_management', difficulty: 'medium', question: 'What does "upselling" mean?', options: ['Selling to new customers', 'Selling additional products to existing customers', 'Increasing prices', 'Selling premium versions'], correctAnswer: '1', explanation: 'Upselling involves selling additional or complementary products/services to existing customers to increase revenue.', points: 3, timeLimit: 2, tags: ['upselling', 'account_growth'], keywords: ['upselling', 'existing_customers', 'revenue'] },
  { questionId: 'sales_014', type: 'multiple_choice', category: 'domain_specific', domain: 'sales', subCategory: 'sales_funnel', difficulty: 'medium', question: 'What is the typical order of stages in a sales funnel?', options: ['Awareness, Interest, Decision, Action', 'Action, Interest, Decision, Awareness', 'Decision, Awareness, Interest, Action', 'Interest, Awareness, Action, Decision'], correctAnswer: '0', explanation: 'The sales funnel typically follows: Awareness → Interest → Decision → Action (AIDA model).', points: 3, timeLimit: 2, tags: ['sales_funnel', 'AIDA'], keywords: ['sales_funnel', 'AIDA', 'stages'] },
  { questionId: 'sales_015', type: 'multiple_choice', category: 'domain_specific', domain: 'sales', subCategory: 'social_selling', difficulty: 'medium', question: 'What is social selling?', options: ['Selling social media accounts', 'Using social networks to find and engage prospects', 'Group selling events', 'Selling to social organizations'], correctAnswer: '1', explanation: 'Social selling uses social media platforms to identify, research, and engage with potential customers and build relationships.', points: 3, timeLimit: 2, tags: ['social_selling', 'digital_sales'], keywords: ['social_selling', 'social_media', 'prospects'] },
  { questionId: 'sales_016', type: 'multiple_choice', category: 'domain_specific', domain: 'sales', subCategory: 'objection_handling', difficulty: 'hard', question: 'When a prospect says "I need to think about it," the best response is:', options: ['Ask when you can follow up', 'Offer a discount', 'Ask what specifically they need to think about', 'End the conversation'], correctAnswer: '2', explanation: 'Understanding what specifically they need to consider helps address underlying concerns and move the sale forward.', points: 4, timeLimit: 3, tags: ['objection_handling', 'closing'], keywords: ['objection', 'think_about_it', 'concerns'] },
  { questionId: 'sales_017', type: 'multiple_choice', category: 'domain_specific', domain: 'sales', subCategory: 'value_proposition', difficulty: 'hard', question: 'What makes a compelling value proposition?', options: ['Lowest price in market', 'Clear benefit that solves a specific problem', 'Longest feature list', 'Best brand recognition'], correctAnswer: '1', explanation: 'A compelling value proposition clearly articulates how your solution solves a specific problem better than alternatives.', points: 4, timeLimit: 3, tags: ['value_proposition', 'differentiation'], keywords: ['value_proposition', 'benefits', 'problem_solving'] },
  { questionId: 'sales_018', type: 'multiple_choice', category: 'domain_specific', domain: 'sales', subCategory: 'sales_metrics', difficulty: 'medium', question: 'What is Customer Acquisition Cost (CAC)?', options: ['Total revenue from customers', 'Cost to acquire one new customer', 'Average order value', 'Customer lifetime value'], correctAnswer: '1', explanation: 'CAC measures the total cost of sales and marketing efforts needed to acquire one new customer.', points: 3, timeLimit: 2, tags: ['sales_metrics', 'CAC'], keywords: ['CAC', 'acquisition_cost', 'customer'] },
  { questionId: 'sales_019', type: 'multiple_choice', category: 'domain_specific', domain: 'sales', subCategory: 'referral_selling', difficulty: 'medium', question: 'What is the best time to ask for referrals?', options: ['During the initial sales call', 'When the customer is satisfied with your service', 'Before closing the deal', 'Only during renewal periods'], correctAnswer: '1', explanation: 'Customers are most likely to provide referrals when they are satisfied and experiencing value from your solution.', points: 3, timeLimit: 2, tags: ['referrals', 'customer_satisfaction'], keywords: ['referrals', 'satisfied_customers', 'timing'] },
  { questionId: 'sales_020', type: 'multiple_choice', category: 'domain_specific', domain: 'sales', subCategory: 'consultative_selling', difficulty: 'hard', question: 'What is consultative selling?', options: ['Selling consulting services', 'Acting as a trusted advisor to understand and solve customer problems', 'Consulting with team before selling', 'Following a standard sales script'], correctAnswer: '1', explanation: 'Consultative selling focuses on understanding customer needs deeply and positioning yourself as a trusted advisor rather than just a vendor.', points: 4, timeLimit: 3, tags: ['consultative_selling', 'advisory'], keywords: ['consultative', 'trusted_advisor', 'customer_needs'] },
  { questionId: 'sales_021', type: 'multiple_choice', category: 'domain_specific', domain: 'sales', subCategory: 'territory_management', difficulty: 'medium', question: 'How should sales territories be designed?', options: ['By geographic proximity only', 'By customer potential and salesperson capacity', 'Randomly assigned', 'By product type only'], correctAnswer: '1', explanation: 'Effective territory design balances customer potential, market opportunity, and individual salesperson capacity for optimal coverage.', points: 3, timeLimit: 2, tags: ['territory_management', 'sales_organization'], keywords: ['territory', 'customer_potential', 'capacity'] },
  { questionId: 'sales_022', type: 'multiple_choice', category: 'domain_specific', domain: 'sales', subCategory: 'enterprise_sales', difficulty: 'hard', question: 'What characterizes enterprise sales cycles?', options: ['Quick decisions, single decision maker', 'Long cycles, multiple stakeholders, complex evaluation', 'Price-focused discussions only', 'Simple product demonstrations'], correctAnswer: '1', explanation: 'Enterprise sales typically involve longer decision cycles, multiple stakeholders, complex evaluation processes, and higher deal values.', points: 4, timeLimit: 3, tags: ['enterprise_sales', 'complex_sales'], keywords: ['enterprise', 'long_cycles', 'stakeholders'] },
  { questionId: 'sales_023', type: 'multiple_choice', category: 'domain_specific', domain: 'sales', subCategory: 'pipeline_management', difficulty: 'medium', question: 'What is sales pipeline hygiene?', options: ['Cleaning sales offices', 'Regularly updating and maintaining accurate pipeline data', 'Organizing sales materials', 'Training new salespeople'], correctAnswer: '1', explanation: 'Pipeline hygiene involves regularly reviewing, updating, and maintaining accurate data about opportunities in your sales pipeline.', points: 3, timeLimit: 2, tags: ['pipeline_management', 'data_quality'], keywords: ['pipeline_hygiene', 'data_accuracy', 'maintenance'] },
  { questionId: 'sales_024', type: 'multiple_choice', category: 'domain_specific', domain: 'sales', subCategory: 'inside_sales', difficulty: 'medium', question: 'What is the main difference between inside sales and field sales?', options: ['Product type sold', 'Inside sales conducted remotely, field sales face-to-face', 'Company size served', 'Price points offered'], correctAnswer: '1', explanation: 'Inside sales is conducted remotely via phone, email, and video, while field sales involves face-to-face meetings at customer locations.', points: 3, timeLimit: 2, tags: ['inside_sales', 'sales_models'], keywords: ['inside_sales', 'remote', 'field_sales'] },
  { questionId: 'sales_025', type: 'multiple_choice', category: 'domain_specific', domain: 'sales', subCategory: 'customer_retention', difficulty: 'hard', question: 'What is Customer Lifetime Value (CLV)?', options: ['One-time purchase amount', 'Total revenue expected from a customer relationship', 'Customer satisfaction score', 'Annual contract value'], correctAnswer: '1', explanation: 'CLV represents the total revenue a business can expect from a customer throughout their entire relationship.', points: 4, timeLimit: 3, tags: ['CLV', 'customer_value'], keywords: ['CLV', 'lifetime_value', 'revenue'] },
  { questionId: 'sales_026', type: 'multiple_choice', category: 'domain_specific', domain: 'sales', subCategory: 'competitive_selling', difficulty: 'hard', question: 'How should you handle direct competitor comparisons?', options: ['Criticize competitor weaknesses', 'Focus on your unique strengths and customer fit', 'Avoid the topic completely', 'Match their prices exactly'], correctAnswer: '1', explanation: 'Focus on your unique value proposition and how your solution best fits the customer\'s specific needs rather than attacking competitors.', points: 4, timeLimit: 3, tags: ['competitive_selling', 'differentiation'], keywords: ['competitive', 'unique_value', 'differentiation'] },
  { questionId: 'sales_027', type: 'multiple_choice', category: 'domain_specific', domain: 'sales', subCategory: 'sales_enablement', difficulty: 'medium', question: 'What is sales enablement?', options: ['Sales training programs only', 'Providing sales teams with tools, content, and training to sell more effectively', 'Setting sales quotas', 'Managing sales territories'], correctAnswer: '1', explanation: 'Sales enablement provides salespeople with the tools, content, training, and processes needed to sell more effectively.', points: 3, timeLimit: 2, tags: ['sales_enablement', 'sales_support'], keywords: ['sales_enablement', 'tools', 'effectiveness'] },
  { questionId: 'sales_028', type: 'multiple_choice', category: 'domain_specific', domain: 'sales', subCategory: 'channel_sales', difficulty: 'medium', question: 'What are channel partners in sales?', options: ['Direct employees only', 'Third-party companies that sell your products/services', 'Internal departments', 'Customer service teams'], correctAnswer: '1', explanation: 'Channel partners are third-party organizations (resellers, distributors, agents) that sell your products or services to end customers.', points: 3, timeLimit: 2, tags: ['channel_sales', 'partnerships'], keywords: ['channel_partners', 'resellers', 'third_party'] },
  { questionId: 'sales_029', type: 'multiple_choice', category: 'domain_specific', domain: 'sales', subCategory: 'sales_coaching', difficulty: 'hard', question: 'What is the primary goal of sales coaching?', options: ['Criticizing poor performance', 'Developing individual salesperson skills and performance', 'Setting higher quotas', 'Monitoring daily activities'], correctAnswer: '1', explanation: 'Sales coaching focuses on developing each salesperson\'s skills, addressing weaknesses, and improving overall performance through guidance and support.', points: 4, timeLimit: 3, tags: ['sales_coaching', 'development'], keywords: ['coaching', 'skill_development', 'performance'] },
  { questionId: 'sales_030', type: 'multiple_choice', category: 'domain_specific', domain: 'sales', subCategory: 'digital_transformation', difficulty: 'hard', question: 'How has digital transformation impacted B2B sales?', options: ['No significant change', 'Buyers are more informed and expect personalized, data-driven interactions', 'Only affects pricing strategies', 'Eliminates need for relationship building'], correctAnswer: '1', explanation: 'Digital transformation has created more informed buyers who expect personalized experiences backed by data and insights throughout their buying journey.', points: 4, timeLimit: 3, tags: ['digital_transformation', 'buyer_behavior'], keywords: ['digital_transformation', 'informed_buyers', 'personalization'] }

  // Continue with Marketing, Finance, Management, and SJT questions...
  // Due to space constraints, I'll create another script for the remaining domains
];

async function completeQuestionBank() {
  try {
    console.log('🚀 Adding remaining questions to reach 30 per domain...');
    console.log(`📊 Processing ${REMAINING_QUESTIONS.length} additional questions`);

    let successCount = 0;
    let skipCount = 0;

    for (const q of REMAINING_QUESTIONS) {
      try {
        const result = await client`
          INSERT INTO question_bank (
            question_id, type, category, domain, sub_category, difficulty, 
            question, options, correct_answer, explanation, points, time_limit, 
            tags, keywords, is_active, created_by
          ) VALUES (
            ${q.questionId}, ${q.type}, ${q.category}, ${q.domain}, ${q.subCategory}, ${q.difficulty},
            ${q.question}, ${q.options}, ${q.correctAnswer}, ${q.explanation}, ${q.points}, ${q.timeLimit},
            ${q.tags}, ${q.keywords}, true, null
          )
          ON CONFLICT (question_id) DO NOTHING
          RETURNING question_id
        `;
        
        if (result.length > 0) {
          successCount++;
          console.log(`✅ Added: ${q.questionId}`);
        } else {
          skipCount++;
        }
      } catch (error) {
        console.error(`❌ Error adding ${q.questionId}:`, error.message);
      }
    }
    
    console.log('');
    console.log(`✅ Added ${successCount} new questions`);
    console.log(`⏭️ Skipped ${skipCount} existing questions`);
    console.log('');
    console.log('📊 Creating additional domains script...');
    
  } catch (error) {
    console.error('❌ Failed:', error);
  } finally {
    await client.end();
  }
}

completeQuestionBank();